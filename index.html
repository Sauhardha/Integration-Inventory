<head>
    <link rel="stylesheet" href="/style.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">


    <title>Integration App</title>
</head>

<body>

    <!---NAV-->
    <nav class="navbar" id="sidebar">
        <ul class="navbar-nav">

            <li class="logo">
                <a href="index.html" class="nav-link">
                    <span class="link-text">Dashboard</span>
                    <svg class="svg-icon" viewBox="0 0 20 20">
                        <path fill=""
                            d="M4.68,13.716v-0.169H4.554C4.592,13.605,4.639,13.658,4.68,13.716z M11.931,6.465 c-0.307-0.087-0.623,0.106-0.706,0.432l-1.389,5.484c-0.901,0.084-1.609,0.833-1.609,1.757c0,0.979,0.793,1.773,1.773,1.773 c0.979,0,1.773-0.794,1.773-1.773c0-0.624-0.324-1.171-0.812-1.486l1.377-5.439C12.422,6.887,12.239,6.552,11.931,6.465z M10.591,14.729H9.408v-1.182h1.183V14.729z M15.32,13.716c0.04-0.058,0.087-0.11,0.126-0.169H15.32V13.716z M10,3.497 c-3.592,0-6.503,2.911-6.503,6.503H4.68c0-2.938,2.382-5.32,5.32-5.32s5.32,2.382,5.32,5.32h1.182 C16.502,6.408,13.591,3.497,10,3.497z M10,0.542c-5.224,0-9.458,4.234-9.458,9.458c0,5.224,4.234,9.458,9.458,9.458 c5.224,0,9.458-4.234,9.458-9.458C19.458,4.776,15.224,0.542,10,0.542z M15.32,16.335v0.167h-0.212 c-1.407,1.107-3.179,1.773-5.108,1.773c-1.93,0-3.701-0.666-5.108-1.773H4.68v-0.167C2.874,14.816,1.724,12.543,1.724,10 c0-4.571,3.706-8.276,8.276-8.276c4.57,0,8.275,3.706,8.275,8.276C18.275,12.543,17.126,14.816,15.32,16.335z">
                        </path>
                    </svg>
                </a>
            </li>

            <li class="nav-item">
                <a href="add.html" class="nav-link">
                    <svg class="svg-icon" viewBox="0 0 30 30">
                        <path 9
                            d="M12 6C12.5523 6 13 6.44772 13 7V11H17C17.5523 11 18 11.4477 18 12C18 12.5523 17.5523 13 17 13H13V17C13 17.5523 12.5523 18 12 18C11.4477 18 11 17.5523 11 17V13H7C6.44772 13 6 12.5523 6 12C6 11.4477 6.44772 11 7 11H11V7C11 6.44772 11.4477 6 12 6Z"
                            10 fill="currentColor" 11 />
                        12
                        <path 13 fill-rule="evenodd" 14 clip-rule="evenodd" 15
                            d="M5 22C3.34315 22 2 20.6569 2 19V5C2 3.34315 3.34315 2 5 2H19C20.6569 2 22 3.34315 22 5V19C22 20.6569 20.6569 22 19 22H5ZM4 19C4 19.5523 4.44772 20 5 20H19C19.5523 20 20 19.5523 20 19V5C20 4.44772 19.5523 4 19 4H5C4.44772 4 4 4.44772 4 5V19Z"
                            16 fill="currentColor" 17 />
                    </svg>
                    <span href="#" class="link-text">Add</span>
                </a>

            </li>

            <li class="nav-item">
                <a href="list.html" class="nav-link">
                    <svg class="svg-icon" viewBox="0 0 30 30">
                        <path d="M5 9V7H7V9H5Z" fill="currentColor" />
                        9
                        <path d="M9 9H19V7H9V9Z" fill="currentColor" />
                        10
                        <path d="M5 15V17H7V15H5Z" fill="currentColor" />
                        11
                        <path d="M19 17H9V15H19V17Z" fill="currentColor" />
                        12
                        <path 13 fill-rule="evenodd" 14 clip-rule="evenodd" 15
                            d="M1 6C1 4.34315 2.34315 3 4 3H20C21.6569 3 23 4.34315 23 6V18C23 19.6569 21.6569 21 20 21H4C2.34315 21 1 19.6569 1 18V6ZM4 5H20C20.5523 5 21 5.44772 21 6V11H3V6C3 5.44772 3.44772 5 4 5ZM3 13V18C3 18.5523 3.44772 19 4 19H20C20.5523 19 21 18.5523 21 18V13H3Z"
                            16 fill="currentColor" 17 />
                    </svg>
                    <span href="#" class="link-text">Saved</span>
                </a>

            </li>

            <li class="nav-item">
                <a href="keys.html" class="nav-link">
                    <svg class="svg-icon" viewBox="0 0 30 30">
                        <path 9 fill-rule="evenodd" 10 clip-rule="evenodd" 11
                            d="M18 10.5C19.6569 10.5 21 11.8431 21 13.5V19.5C21 21.1569 19.6569 22.5 18 22.5H6C4.34315 22.5 3 21.1569 3 19.5V13.5C3 11.8431 4.34315 10.5 6 10.5V7.5C6 4.18629 8.68629 1.5 12 1.5C15.3137 1.5 18 4.18629 18 7.5V10.5ZM12 3.5C14.2091 3.5 16 5.29086 16 7.5V10.5H8V7.5C8 5.29086 9.79086 3.5 12 3.5ZM18 12.5H6C5.44772 12.5 5 12.9477 5 13.5V19.5C5 20.0523 5.44772 20.5 6 20.5H18C18.5523 20.5 19 20.0523 19 19.5V13.5C19 12.9477 18.5523 12.5 18 12.5Z"
                            12 fill="currentColor" 13 />
                    </svg>
                    <span href="#" class="link-text">Keys</span>
                </a>

            </li>

            <li class="nav-item">
                <a href="instructions.html" class="nav-link">
                    <svg class="svg-icon" viewBox="0 0 30 30">
                        <path 9
                            d="M8 11C7.44772 11 7 11.4477 7 12C7 12.5523 7.44772 13 8 13H15.9595C16.5118 13 16.9595 12.5523 16.9595 12C16.9595 11.4477 16.5118 11 15.9595 11H8Z"
                            10 fill="currentColor" 11 />
                        12
                        <path 13
                            d="M8.04053 15.0665C7.48824 15.0665 7.04053 15.5142 7.04053 16.0665C7.04053 16.6188 7.48824 17.0665 8.04053 17.0665H16C16.5523 17.0665 17 16.6188 17 16.0665C17 15.5142 16.5523 15.0665 16 15.0665H8.04053Z"
                            14 fill="currentColor" 15 />
                        16
                        <path 17 fill-rule="evenodd" 18 clip-rule="evenodd" 19
                            d="M5 3C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3H5ZM7 5H5L5 19H19V5H17V6C17 7.65685 15.6569 9 14 9H10C8.34315 9 7 7.65685 7 6V5ZM9 5V6C9 6.55228 9.44772 7 10 7H14C14.5523 7 15 6.55228 15 6V5H9Z"
                            20 fill="currentColor" 21 />
                    </svg>
                    <span href="#" class="link-text">Instructions</span>
                </a>

            </li>

        </ul>
    </nav>

    <!--------------- DASH BANNER ------------------->
    <div class="container">
        <main>
            <h1> Integration Dashboard </h1>
            <!----------CARDS---------------------------->
            <div class="cards">
                <div class="item1" id="item1">
                    <i class="material-icons"> move_up </i>
                    <div class="middle">
                        <div class="left">
                            <h3>GRNs Remaining:</h3>
                            <h2 id="totalGrns"></h2>

                        </div>

                        <div class="progress">
                            <svg>
                                <circle cx="38" cy="38" r="36" stroke="black" fill="#fff"></circle>
                            </svg>
                            <div class="number">
                                <p></p>
                            </div>
                        </div>

                    </div>
                    <small class="text-muted">As of <span id="displayDate"></span> </small>
                </div>
                <!---------------- END OF CARD ITEM NOs --------------->
                <div class="item2" id="item2">
                    <i class="material-icons"> analytics </i>
                    <div class="middle">
                        <div class="left">
                            <h3>Total Units Remaing:</h3>
                            <h2 id="itemSum"></h2>
                        </div>
                        <!--<div class="progress">
                            <svg>
                                <circle cx="38" cy="38" r="36" stroke="black" fill="#735FCB"></circle>
                            </svg>
                            <div class="number">
                                <p></p>
                            </div>
                        </div>-->
                    </div>
                    <small class="text-muted">Last 24 Hours</small>
                </div>
                <!---------------- END OF CARD ITEM NOs --------------->
                <div class="item3" id="item3">

                    <div class="clock">
                        <div class="hour">
                            <div class="hr" id="hr"></div>
                        </div>
                        <div class="min">
                            <div class="mn" id="mn"></div>
                        </div>
                        <div class="sec">
                            <div class="sc" id="sc"></div>
                        </div>
                    </div>




                </div>
                <!---------------- END OF CARD ITEM NOs --------------->

            </div>
            <!--- RECENT ITEMS  -->
            <div class="recent-grns">
                <h2>Recent Items</h2>
                <table>
                    <thead>
                        <tr>
                            <th>GRN</th>
                            <th>Desktops</th>
                            <th>Notebooks</th>
                            <th>Monitors</th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr>

                        </tr>
                    </tbody>
                </table>
                <a href="list.html">Show All</a>
            </div>


        </main>
        <!-----------END OF MAIN-->

        <!--- RIGHT SIDE -->
        <div class="right" style="padding-right: 1rem;">
            <div class="top">
                <div class="profile">
                    <div class="info">
                        <p>Account <b>User</b></p>
                        <small class="text-muted">Admin</small>
                    </div>
                    <div class="profile-photo">
                        <img src="./user.png" alt="">
                    </div>
                </div>
            </div>
            <!--END OF TOP-->
            <div class="recent-updates">
                <h2>Updates</h2>
                <div class="updates">
                    <div class="update">
                        <div class="profile-photo">
                            <img src="/user.png" alt="">
                        </div>
                        <div class="message">
                            <p><b>John Doe</b> received his order of Dell XPS 13</p>
                            <small class="text-muted">5 Minutes Ago</small>
                        </div>
                    </div>

                    <div class="update">
                        <div class="profile-photo">
                            <img src="/user.png" alt="">
                        </div>
                        <div class="message">
                            <p><b>Mary Smith</b> received his order of HP Spectre</p>
                            <small class="text-muted">7 Minutes Ago</small>
                        </div>

                    </div>

                    <div class="update">
                        <div class="profile-photo">
                            <img src="/user.png" alt="">
                        </div>
                        <div class="message">
                            <p><b>Peter Johnson</b> received his order of MacBook Pro</p>
                            <small class="text-muted">20 Minutes Ago</small>
                        </div>

                    </div>



                </div>

            </div>
        </div>

    </div>

</body>

<script>
    const deg = 6;
    const hr = document.querySelector('#hr');
    const mn = document.querySelector('#mn');
    const sc = document.querySelector('#sc');

    setInterval(() => {

        let day = new Date();
        let hh = day.getHours() * 30;
        let mm = day.getMinutes() * deg;
        let ss = day.getSeconds() * deg;

        hr.style.transform = `rotateZ(${(hh)+(mm/12)}deg)`;
        mn.style.transform = `rotateZ(${mm}deg)`;
        sc.style.transform = `rotateZ(${ss}deg)`;
    })




    document.addEventListener('DOMContentLoaded', function () {
        fetch('http://localhost:5100/getAll')
            .then(response => response.json())
            .then(data => loadHTMLTable(data['data']));

        fetch('http://localhost:5100/sumAll')
            .then(response => response.json())
            .then(data => loadItemCount(data['data']));
    });

    // DATE
    function displaytime() {
        var session = "";
        var month = ["January", "February", "March", "April", "May", "June", "July", "August", "September",
            "October", "November", "December"
        ];
        var daylist = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

        var today = new Date();
        var day = today.getDay();
        var date = today.getFullYear() + "/" + (today.getMonth() + 1) + "/" + today.getDate();


        document.getElementById("displayDate").innerHTML = daylist[day] + ", " + month[today.getMonth()] + " " +
            today.getDate();
    }
    setInterval(displaytime, 10);



    function loadItemCount(data) {
        const totalSum = data[0].total_sum;
        document.getElementById("itemSum").innerHTML = totalSum;
    }



    function loadHTMLTable(data) {
        const table = document.querySelector('table tbody');

        var grnsInt = 0;
        const displayTotalGrns = document.getElementById('totalGrns');


        if (data.length === 0) {
            table.innerHTML = "<tr><td class='no-data' colspan='5'>No Data</td></tr>";
        }

        let tableHtml = "";

        // Count Total GRNs
        data.forEach(function ({
            GRN
        }) {
            grnsInt += 1;
        });

        if (grnsInt >= 0) {
            displayTotalGrns.innerHTML = grnsInt;
        }


        //Fill Recent Grns Table

        data.forEach(function ({
            GRN,
            Desktops,
            Notebooks,
            Monitors
        }) {
            tableHtml += "<tr>";
            tableHtml += `<td>${GRN}</td>`;
            tableHtml += `<td>${Desktops}</td>`;
            tableHtml += `<td>${Notebooks}</td>`;
            tableHtml += `<td>${Monitors}</td>`;
            tableHtml += "</tr>";
        });



        table.innerHTML = tableHtml;
    }
</script>